<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Rotation Bias and Circadian Analysis with RootScanR â€¢ RootScanR</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Aleo-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rotation Bias and Circadian Analysis with RootScanR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RootScanR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/RootScanR.html">Tutorial</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip>DemoFile</h6></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jcunow/RootScanR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rotation Bias and Circadian Analysis with RootScanR</h1>
                        <h4 data-toc-skip class="author">Johannes
Cunow</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jcunow/RootScanR/blob/main/vignettes/Rotation_Bias_vignettes.Rmd" class="external-link"><code>vignettes/Rotation_Bias_vignettes.Rmd</code></a></small>
      <div class="d-none name"><code>Rotation_Bias_vignettes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="rotation-bias-analysis">Rotation Bias Analysis<a class="anchor" aria-label="anchor" href="#rotation-bias-analysis"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This vignette demonstrates how to analyze rotation and methodological
bias of a minirhizotron setup using the <strong>RootScanR</strong>
package. In minirhizotron studies, roots may exhibit preferential growth
areas on the tube surface depending on the tube size and tube insertion
angle. This might also affect how roots behave at the surface itself by
e.g., changing root growth angles.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the package from GitHub</span></span>
<span><span class="co"># install.packages("remotes")</span></span>
<span><span class="co"># remotes::install_github("jcunow/RootScanR")</span></span>
<span></span>
<span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jcunow/RootScanR" class="external-link">RootScanR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># For enhanced plotting</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="key-functionalities">Key Functionalities<a class="anchor" aria-label="anchor" href="#key-functionalities"></a>
</h3>
<p>The rotation bias and circadian analysis module includes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sine Curve Fitting</strong>: Model circadian rhythms in root
growth data</li>
<li>
<strong>Statistical Testing</strong>: Assess the significance of
observed rhythmic patterns</li>
<li>
<strong>Bias Quantification</strong>: Calculate metrics for
directional growth preferences</li>
<li>
<strong>Visualization Tools</strong>: Create informative plots of
temporal patterns</li>
</ol>
</div>
<div class="section level3">
<h3 id="example-workflow">Example Workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h3>
<div class="section level4">
<h4 id="preparing-time-series-data">1. Preparing Time-Series Data<a class="anchor" aria-label="anchor" href="#preparing-time-series-data"></a>
</h4>
<p><strong>Purpose</strong>: Organize your time-series observations of
root growth for analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Loading time-series data</span></span>
<span><span class="co"># In a real scenario, you would load your own data from files</span></span>
<span><span class="co"># The data should contain timestamps and root measurements</span></span>
<span></span>
<span><span class="co"># For demonstration, we'll generate synthetic data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">32608</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span><span class="va">period</span> <span class="op">&lt;-</span> <span class="fl">24</span>     <span class="co"># 24-hour cycle</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>          <span class="co"># Number of observations</span></span>
<span><span class="va">timestamps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">*</span><span class="va">period</span><span class="op">)</span>  <span class="co"># Random sampling times across 3 days</span></span>
<span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fl">2</span>   <span class="co"># Strength of the rhythm</span></span>
<span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="fl">6</span>       <span class="co"># Time offset (hours)</span></span>
<span><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fl">3</span>    <span class="co"># Average growth rate</span></span>
<span><span class="va">noise</span> <span class="op">&lt;-</span> <span class="fl">1</span>       <span class="co"># Random variation</span></span>
<span></span>
<span><span class="co"># Simulate root growth with circadian pattern</span></span>
<span><span class="va">growth_rates</span> <span class="op">&lt;-</span> <span class="va">amplitude</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="va">period</span> <span class="op">*</span> <span class="op">(</span><span class="va">timestamps</span> <span class="op">+</span> <span class="va">phase</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="va">baseline</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="va">noise</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame for analysis</span></span>
<span><span class="va">root_ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">timestamps</span>,</span>
<span>  growth_rate <span class="op">=</span> <span class="va">growth_rates</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the raw time-series data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">root_ts_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">growth_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Root Growth Rate Time Series"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time (hours)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Growth Rate (mm/hour)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fitting-circadian-models">2. Fitting Circadian Models<a class="anchor" aria-label="anchor" href="#fitting-circadian-models"></a>
</h4>
<p><strong>Purpose</strong>: Detect and characterize circadian rhythms
in root growth patterns.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a sine curve to the time-series data</span></span>
<span><span class="va">circadian_fit</span> <span class="op">&lt;-</span> <span class="fu">fit_circadian_model</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span>,  <span class="co"># Fixed 24-hour period</span></span>
<span>  method <span class="op">=</span> <span class="st">"nls"</span> <span class="co"># Non-linear least squares</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display model parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Circadian model parameters:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">circadian_fit</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the data with fitted curve</span></span>
<span><span class="fu">plot_circadian_fit</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  fit <span class="op">=</span> <span class="va">circadian_fit</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Circadian Rhythm in Root Growth"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="statistical-testing-for-rhythmicity">3. Statistical Testing for Rhythmicity<a class="anchor" aria-label="anchor" href="#statistical-testing-for-rhythmicity"></a>
</h4>
<p><strong>Purpose</strong>: Determine if the observed patterns are
statistically significant circadian rhythms.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform statistical tests to validate circadian rhythms</span></span>
<span></span>
<span><span class="co"># 1. Wald Test (tests if amplitude is significantly different from zero)</span></span>
<span><span class="va">wald_result</span> <span class="op">&lt;-</span> <span class="fu">test_circadian_wald</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Wald test for circadian rhythmicity:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wald_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Likelihood Ratio Test (compares rhythmic vs. constant models)</span></span>
<span><span class="va">lr_result</span> <span class="op">&lt;-</span> <span class="fu">test_circadian_lr</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Likelihood Ratio test for circadian rhythmicity:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lr_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. F Test (tests overall model significance)</span></span>
<span><span class="va">f_result</span> <span class="op">&lt;-</span> <span class="fu">test_circadian_f</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"F test for circadian rhythmicity:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f_result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="period-analysis">4. Period Analysis<a class="anchor" aria-label="anchor" href="#period-analysis"></a>
</h4>
<p><strong>Purpose</strong>: Identify the dominant period in root growth
patterns when the period is unknown.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scan for the most likely period in the data</span></span>
<span><span class="va">period_scan</span> <span class="op">&lt;-</span> <span class="fu">analyze_circadian_period</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  values <span class="op">=</span> <span class="va">root_ts_data</span><span class="op">$</span><span class="va">growth_rate</span>,</span>
<span>  period_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span><span class="op">)</span>,  <span class="co"># Test periods between 12 and 36 hours</span></span>
<span>  step <span class="op">=</span> <span class="fl">0.5</span>                 <span class="co"># Step size in hours</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot period scan results</span></span>
<span><span class="fu">plot_period_scan</span><span class="op">(</span></span>
<span>  <span class="va">period_scan</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Period Analysis of Root Growth"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify the best-fitting period</span></span>
<span><span class="va">best_period</span> <span class="op">&lt;-</span> <span class="va">period_scan</span><span class="op">$</span><span class="va">period</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">period_scan</span><span class="op">$</span><span class="va">residual_sum_squares</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Best-fitting period: "</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">best_period</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">" hours"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rotation-bias-analysis-1">5. Rotation Bias Analysis<a class="anchor" aria-label="anchor" href="#rotation-bias-analysis-1"></a>
</h4>
<p><strong>Purpose</strong>: Quantify directional preferences in root
growth around minirhizotron tubes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For rotation bias, we need data that includes angular positions</span></span>
<span><span class="co"># In a minirhizotron, this would be the angular position around the tube</span></span>
<span></span>
<span><span class="co"># For demonstration, we'll generate synthetic rotation data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_roots</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">angular_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_roots</span>, <span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span>  <span class="co"># Angles in degrees</span></span>
<span></span>
<span><span class="co"># Simulate a bias toward the bottom of the tube (180 degrees)</span></span>
<span><span class="va">bias_center</span> <span class="op">&lt;-</span> <span class="fl">180</span></span>
<span><span class="va">bias_strength</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">bias_strength</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">angular_positions</span>, <span class="va">bias_center</span>, <span class="fl">45</span><span class="op">)</span> <span class="op">+</span> </span>
<span>           <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">bias_strength</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">angular_positions</span>, <span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span></span>
<span>           </span>
<span><span class="co"># Normalize to create a probability of root presence</span></span>
<span><span class="va">probability</span> <span class="op">&lt;-</span> <span class="va">density</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span> <span class="op">*</span> <span class="va">n_roots</span></span>
<span><span class="va">root_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_roots</span>, <span class="va">probability</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame for analysis</span></span>
<span><span class="va">rotation_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  angle <span class="op">=</span> <span class="va">angular_positions</span>,</span>
<span>  root_count <span class="op">=</span> <span class="va">root_counts</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze rotation bias</span></span>
<span><span class="va">rotation_bias</span> <span class="op">&lt;-</span> <span class="fu">analyze_rotation_bias</span><span class="op">(</span></span>
<span>  angles <span class="op">=</span> <span class="va">rotation_data</span><span class="op">$</span><span class="va">angle</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rotation_data</span><span class="op">$</span><span class="va">root_count</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">24</span>  <span class="co"># Number of angular bins</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Rotation bias metrics:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rotation_bias</span><span class="op">$</span><span class="va">metrics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize rotation bias</span></span>
<span><span class="fu">plot_rotation_bias</span><span class="op">(</span></span>
<span>  <span class="va">rotation_bias</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Root Growth Rotation Bias"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="combined-temporal-and-directional-analysis">6. Combined Temporal and Directional Analysis<a class="anchor" aria-label="anchor" href="#combined-temporal-and-directional-analysis"></a>
</h4>
<p><strong>Purpose</strong>: Investigate if rotation bias changes with
circadian rhythms.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For this analysis, we need data that combines time and angular position</span></span>
<span><span class="co"># Generate synthetic data for demonstration</span></span>
<span></span>
<span><span class="co"># Create time points across 3 days</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">72</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">n_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">time_points</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create angular positions</span></span>
<span><span class="va">angle_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">345</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">n_angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">angle_points</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a matrix of root counts with time-dependent rotation bias</span></span>
<span><span class="va">root_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n_times</span>, ncol <span class="op">=</span> <span class="va">n_angles</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">root_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">angle_points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">root_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">time_points</span></span>
<span></span>
<span><span class="co"># Simulate time-varying bias</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_times</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time_points</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Bias center shifts over time (simulating heliotropism)</span></span>
<span>  <span class="va">bias_center</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">180</span> <span class="op">+</span> <span class="fl">45</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">360</span></span>
<span>  </span>
<span>  <span class="co"># Generate root counts with the time-dependent bias</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_angles</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">angle</span> <span class="op">&lt;-</span> <span class="va">angle_points</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">-</span> <span class="va">bias_center</span><span class="op">)</span>, <span class="fl">360</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">-</span> <span class="va">bias_center</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">root_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">distance</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Analyze time-dependent rotation bias</span></span>
<span><span class="va">temporal_bias</span> <span class="op">&lt;-</span> <span class="fu">analyze_temporal_rotation_bias</span><span class="op">(</span></span>
<span>  root_matrix <span class="op">=</span> <span class="va">root_matrix</span>,</span>
<span>  time_points <span class="op">=</span> <span class="va">time_points</span>,</span>
<span>  angle_points <span class="op">=</span> <span class="va">angle_points</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Temporal rotation bias results:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">temporal_bias</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize time-dependent rotation bias</span></span>
<span><span class="fu">plot_temporal_bias</span><span class="op">(</span></span>
<span>  <span class="va">temporal_bias</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Time-Dependent Root Growth Direction"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="advanced-applications">Advanced Applications<a class="anchor" aria-label="anchor" href="#advanced-applications"></a>
</h3>
<div class="section level4">
<h4 id="comparing-rotation-bias-between-treatments">Comparing Rotation Bias Between Treatments<a class="anchor" aria-label="anchor" href="#comparing-rotation-bias-between-treatments"></a>
</h4>
<p><strong>Purpose</strong>: Determine if different experimental
treatments affect root directional preferences.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data for two treatments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Treatment 1: Strong downward bias</span></span>
<span><span class="va">angles_t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">180</span>, sd <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">360</span></span>
<span><span class="va">counts_t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Treatment 2: Weaker, more diffuse bias</span></span>
<span><span class="va">angles_t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">180</span>, sd <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">360</span></span>
<span><span class="va">counts_t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze rotation bias for each treatment</span></span>
<span><span class="va">bias_t1</span> <span class="op">&lt;-</span> <span class="fu">analyze_rotation_bias</span><span class="op">(</span><span class="va">angles_t1</span>, <span class="va">counts_t1</span>, bins <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">bias_t2</span> <span class="op">&lt;-</span> <span class="fu">analyze_rotation_bias</span><span class="op">(</span><span class="va">angles_t2</span>, <span class="va">counts_t2</span>, bins <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare bias strength statistically</span></span>
<span><span class="va">bias_comparison</span> <span class="op">&lt;-</span> <span class="fu">compare_rotation_bias</span><span class="op">(</span></span>
<span>  <span class="va">bias_t1</span>, </span>
<span>  <span class="va">bias_t2</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rayleigh"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Bias comparison results:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bias_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the comparison</span></span>
<span><span class="fu">plot_bias_comparison</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Treatment1 <span class="op">=</span> <span class="va">bias_t1</span>, Treatment2 <span class="op">=</span> <span class="va">bias_t2</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Rotation Bias Comparison Between Treatments"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>This vignette has demonstrated how to analyze rotation bias and
circadian rhythms in root growth using the RootScanR package. These
analyses can reveal important aspects of root growth strategies and
responses to environmental cues such as light, gravity, and daily
temperature cycles.</p>
<p>Key takeaways: 1. Circadian rhythms can be detected and characterized
using sine curve fitting 2. Statistical tests help validate the
significance of observed rhythms 3. Rotation bias analysis quantifies
directional preferences in root growth 4. Combined temporal and
directional analysis can reveal complex growth patterns</p>
<p>For more detailed information about specific functions and additional
features, please refer to the function documentation and the package
GitHub repository at <a href="https://github.com/jcunow/RootScanR" class="external-link">https://github.com/jcunow/RootScanR</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Cunow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
